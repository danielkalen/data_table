!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("smart-extend"),require("event-lite"),require("jquery"),require("escape-html"),require("@danielkalen/simplybind")):"function"==typeof define&&define.amd?define(["smart-extend","event-lite","jquery","escape-html","@danielkalen/simplybind"],t):(e=e||self)["@danielkalen/data_table"]=t(e.extend$1,e.EventEmitter,e.$$1,e.escHTML,e.SimplyBind)}(this,function(e,t,s,i,a){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,s=s&&s.hasOwnProperty("default")?s.default:s,i=i&&i.hasOwnProperty("default")?i.default:i,a=a&&a.hasOwnProperty("default")?a.default:a;var n,r,o={perPage:20,pageCountMax:10,minWidth:0,mobileWidth:736,cellsHavePadding:!1,hasMobile:!0,loadOnInit:!0,columns:[],search:[],percentage:{},baseClass:"DataTable",showPageStatus:!0,sortBy:"",alignment:"left",actions:!1,ipDataFetcher:function(e){return new Promise(function(t){return $.get(`http://ipinfo.io/${e}`,t,"JSON")})}},l=function({ID:e,baseClass:t,minWidth:s,hasMobile:i,cellsHavePadding:a}){return`<div id='${t}-${e}' class='${t}-outerwrap {{loading}} {{noResults}} {{hasError}} ${s?"_hasMinWidth":""} ${i?"{{mobileVersion}}":""} ${a?"_cellsHavePadding":""} '></div>`},c=function({baseClass:e,alignment:t}){return`<div class='${e} alignment---${t} sortDirection---{{sortDirection}}'> <div class='${e}-heading'> <div class='${e}-heading-row'></div> </div> <div class='${e}-body'></div> </div>`},u=function({baseClass:e}){return`<div class='${e}-loading {{isVisible}}'> <div class='${e}-loading-innerwrap'> <div class='${e}-loading-icon'></div> <div class='${e}-loading-text'>Loading</div> </div> </div>`},d=function({baseClass:e,itemSingleLabel:t="Item",itemPluralLabel:s=t+"s"}){return`<div class='${e}-noResults {{isVisible}}'> <div class='${e}-noResults-innerwrap'> <div class='${e}-noResults-icon'></div> <div class='${e}-noResults-text'> <div class='${e}-noResults-text-title'>No ${t}s to Display</div> <div class='${e}-noResults-text-subtitle'>There are no matching ${s} for the search query you've typed.</div> </div> </div> </div>`},h=function({baseClass:e}){return`<div class='${e}-error {{isVisible}}'> <div class='${e}-error-innerwrap'> <div class='${e}-error-icon'></div> <div class='${e}-error-text'> <div class='${e}-error-text-title'>A Fatal Error has Occured</div> <div class='${e}-error-text-subtitle'>Report the following to the admin:<br />"{{errorMessage}}"</div> </div> </div> </div>`},p=function({baseClass:e,showPageStatus:t}){return`<div class='${e}-pageStatus ${t?"is_visible":""}'> Showing {{rowRange}} of {{totalRows}} </div>`},f=function({baseClass:e}){return`<div class='${e}-pagination {{hasExtra}} {{isVisible}}'> <div class='${e}-pagination-item _paginationItem _back'> <div class='${e}-pagination-item-text'></div> </div> <div class='${e}-pagination-itemswrap _paginationItems'></div> <div class='${e}-pagination-item _paginationItem _extraIndicator'> <div class='${e}-pagination-item-text'></div> <select class='${e}-pagination-item-select'></select> </div> <div class='${e}-pagination-item _paginationItem _next'> <div class='${e}-pagination-item-text'></div> </div> </div>`},g=function({baseClass:e,value:t}){return`<div class='${e}-pagination-item _paginationItem'> <div class='${e}-pagination-item-text'>${t}</div> </div>`},v=function({baseClass:e,extraClasses:t="",slug:s,icon:i="",label:a,style:n=""}){return`<div class='${e}-heading-row-cell ${t} __${s}' data-slug='${s}' data-icon='${i}' ${n}> <div class='${e}-heading-row-cell-text'>${a}</div> </div>`},w=function({baseClass:e,rowID:t,cells:s,drilldown:i=""}){return`<div class='${e}-body-row _tableRow {{drilldownState}}' data-row-id='${t}'> <div class='${e}-body-row-expandDrilldown _expandDrilldown'> <div class='${e}-body-row-expandDrilldown-icon'></div> </div> ${s} <div class='${e}-body-row-drilldown _tableRowDrilldown'> ${i} </div> </div>`},b=function({baseClass:e,extraClasses:t="",label:s,column:i,slug:a,value:n,style:r=""}){return`<div class='${e}-body-row-cell __${a} ${t}' data-slug='${a}' data-column='${i}' ${r}> <div class='${e}-body-row-cell-innerwrap' title='${s}'>${n}</div> </div>`},m=function({baseClass:e,search:t}){return`<div class='${e}-search ${(null!=t?t.length:void 0)?"is_visible":""}'> <select class='${e}-search-select'></select> <input class='${e}-search-input' /> <div class='${e}-search-selectTrigger'></div> </div>`},y=function({baseClass:e,ipAddress:t,extra:s=""}){return`<div class='${e}-ipDetails _ipDetails' data-ip='${t}'> <div class='${e}-ipDetails-trigger _ipDetails-trigger'></div> <div class='${e}-ipDetails-content'>Loading IP Details</div> </div> ${s}`},C=function({baseClass:e,label:t,value:s}){return`<div class='${e}-ipDetails-content-item'> <div class='${e}-ipDetails-content-item-label'>${t}: </div> <div class='${e}-ipDetails-content-item-value'>${s}</div> </div>`},B=function({baseClass:e,fields:t}){return`<div class='${e}-fieldGroup'>${t}</div>`},k=function({baseClass:e,label:t,value:s}){return`<div class='${e}-fieldGroup-item'> <div class='${e}-fieldGroup-item-label'>${t}: </div> <div class='${e}-fieldGroup-item-value'>${i(s)}</div> </div>`},x=function({baseClass:e,action:t,icon:s="",isMulti:i}){return`<div class='${e}-button _actionButton ${i?"_isMulti":""}' data-action='${t}'> <div class='${e}-button-icon'>${s}</div> </div>`},R=function({baseClass:e,actions:t}){return`<div class='${e}-actions'> <div class='${e}-actions-popup'>${t}</div> </div>`},_=function(){return`<div class='${j.defaults.baseClass}-actions-overlay'></div>`},M=function({baseClass:e,action:t,icon:s,label:i,customIconStyle:a=""}){return`<div class='${e}-actions-popup-item _actionButton _subActionButton' data-action='${t}' style='${a}'> <div class='${e}-actions-popup-item-icon'>${s}</div> <div class='${e}-actions-popup-item-text'>${i}</div> </div>`},P=Object.freeze({tableOuterwrap:l,table:c,loading:u,noResults:d,error:h,pageStatus:p,pagination:f,paginationItem:g,headingCell:v,row:w,rowCell:b,searchField:m,ipDetails:y,ipDetailsItem:C,fields:B,fieldsItem:k,button:x,actions:R,actionsOverlay:_,actionsItem:M}),D=function(e,t){switch(!1){case typeof e!=typeof t:return e===t;case"string"!=typeof e:return e===""+t;case"number"!=typeof e:return e===parseFloat(t)}},O=function(e){var t,i;return(t=e.data("isOpen"))?(e.data("overlay").remove(),e.removeClass("is_visible")):(e.data("overlay",i=s(_())),e.addClass("is_visible"),i.appendTo(document.body).one("click",function(){return O(e)})),e.data("isOpen",!t)},I=function(e){var t,s,i,a,n,r,o,l;if(Array.isArray(e)){if(o={},"string"==typeof e[0])for(s=0,n=e.length;s<n;s++)o[a=e[s]]={label:a};else if(null!=(l=e[0])?l.label:void 0)for(i=0,r=e.length;i<r;i++)o[(t=e[i]).label]=t}else o=e;for(a in o)null==(t=o[a]).label&&(t.label=a),null==t.slug&&(t.slug=t.label.toLowerCase().replace(/\W/g,"_")),null==t.type&&(t.type="text");return o},S=function(e,t){return e.breakdownBarTotal/t*82},T=function(e){var t;return t="",e.width&&(t+=`max-width: ${e.width};`),e.grow>=0&&(t+=`flex-grow: ${e.grow};`),t?`style='${t}'`:""},E=function(e){var t;return t="",e.width&&(t+=`max-width: ${e.width};`),e.color&&(t+=`color: ${this.colorMapping(e.color,e.colorType)};`),e.customStyle&&(t+=e.customStyle),e.grow>=0&&(t+=`flex-grow: ${e.grow};`),t?`style='${t}'`:""},A=function(e){var t;return t="",e.sortable&&(t+=" _isSortable {{currentSort}}"),e.noLabel&&(t+=" _noLabel"),e.isLink&&(t+=" _isLink"),e.noEllipsis&&(t+=" _noEllipsis"),e.showOverflow&&(t+=" _showOverflow"),e.color&&(t+=" _hasColor"),"button"!==e.type&&"actions"!==e.type||(t+=" _isButton",e.alwaysCenter=!0),"breakdownBar"===e.type&&(t+=" _isBreakdownBar"),"ipDetails"===e.type&&(t+=" _isIpDetails"),"fields"===e.type&&(t+=" _isFields"),e.alwaysCenter&&(t+=" _alwaysCenter"),t},W=Object.freeze({compareValues:D,toggleActionsPopup:O,getBreakdownTotal:function(e,t){switch(!1){case 0!==t.length:return 0;default:return t.map(function(t){return e[t]}).reduce(function(e,t){return e+t})}},normalizeColumns:I,getBreakdownBarWidth:S,genHeaderCellStyle:T,genCellStyle:E,genCellClassname:A,colorMapping:function(e,t="name"){switch(t){case"browser":switch(!1){case!e.includes("Firefox"):return this.colorMapping("orange");case!e.includes("Chrome"):return this.colorMapping("green");case!e.includes("Safari"):case!e.includes("Mobile Safari"):return this.colorMapping("blue");case!e.includes("IE"):case!e.includes("Edge"):return this.colorMapping("lightblue");case!e.includes("Opera"):return this.colorMapping("red");case!e.includes("Android"):return this.colorMapping("lightgreen");default:return"unknown"}break;case"platform":switch(e){case"Mac OS X":return this.colorMapping("black");case"Windows":return this.colorMapping("lightblue");case"Windows Phone":return this.colorMapping("purple");case"Linux":return this.colorMapping("darkyellow");case"iOS":return this.colorMapping("black");case"Android":return this.colorMapping("lightgreen");default:return"unknown"}break;case"satisfaction":switch(e){case"Excellent":return this.colorMapping("green");case"Normal":return this.colorMapping("yellow");case"Poor":return this.colorMapping("red");default:return"unknown"}break;case"name":switch(e){case"orange":return"#ee6f0e";case"green":return"#00ad09";case"blue":return"#4788f3";case"yellow":return"#eab71e";case"red":return"#cc4820";case"black":return"#181818";case"purple":return"#a020ba";case"lightblue":return"#0cb3ee";case"lightgreen":return"#78c257";case"darkyellow":return"#e8ac01"}break;default:return e}},iconMapping:function(e,t){switch(t){case"browser":switch(!1){case!e.includes("Firefox"):return"#";case!e.includes("Chrome"):return"%";case!e.includes("Safari"):case!e.includes("Mobile Safari"):return"$";case!e.includes("IE"):case!e.includes("Edge"):return"&";case!e.includes("Opera"):return'"';case!e.includes("Android"):return"&#039;";default:return"4"}break;case"device":switch(e){case"Desktop":return"!";case"Tablet":return"7";case"Mobile":return"6";default:return"4"}break;case"platform":switch(e){case"Mac OS X":return"*";case"Windows":case"Windows Phone":return")";case"Linux":return"+";case"iOS":return"*";case"Android":return"&#039;";default:return"4"}break;case"satisfaction":switch(e){case"Excellent":return"[";case"Normal":return"@";case"Poor":return"?";default:return"4"}break;default:return"4"}}}),F=Object.freeze({calcPageCount:function(e){return this.pageCountReal=Math.ceil(e.length/this.options.perPage),this.pageCount=this.pageCountReal>this.options.pageCountMax?this.options.pageCountMax:this.pageCountReal},calcPercentageString:function(e,t,s){var i,a,n,r,o;return n=this.options.percentage[t],i=n[0],a=n[2],r=n[1],Infinity===(o=function(){switch(r){case"*":return s[i]*s[a];case"/":return s[i]/s[a];case"+":return s[i]+s[a];case"-":return s[i]-s[a]}}())&&(o=0),`${e} (${convertToPercent(o)})`},sortRows:function(e,t=this.options.sortBy){var s,i,a;switch(!1){case"+"!==t:return e;case"-"!==t:return null!=e?e.slice().reverse():void 0;case!this.options.columns[t]:return s=this.options.columns[t].sortFn,i=this.options.columns[t].rawValueFormatter,(a=s)||(a=((e,s)=>{var a,n;switch(a=i?i(e[t]):e[t],n=i?i(s[t]):s[t],!1){case!(a>n):return this.sortDirection;case!(a<n):return-1*this.sortDirection;default:return 0}})),e.slice().sort(a);default:return e}},setVisiblePage:function(e){var t,s,i,a,n;for(n={start:--e*this.options.perPage,end:e*this.options.perPage+this.options.perPage},a=this.availableRows.slice(n.start,n.end),t=0,s=(i=this.visibleRows.slice()).length;t<s;t++)i[t].visible=!1;return this.visibleRows.length=0,this.visibleRows.push.apply(this.visibleRows,a)},setPageIndicator:function(e){var t,s;return"..."===e&&(e=1),e=e>this.options.pageCountMax?this.options.pageCountMax:e-1,(t=(s=this.els.pagination.find("._paginationItem").slice(1,-1)).eq(e)).addClass("current"),s.not(t).removeClass("current")},generateHeadingColumns:function(){var e,t;return this.options.columns=I(this.options.columns),function(){var s,i;for(t in i=[],s=this.options.columns)e=s[t],i.push("breakdownBar"===e.type);return i}.call(this)&&(this.hasBreakdownBar=!0),Object.keys(this.options.columns).map(t=>(e=this.options.columns[t],this.els.globalStyles[0].innerHTML+=`{{${e.slug}}}\n`,v(this.markupArgs({slug:e.slug,icon:e.icon,label:e.label,style:T(e),extraClasses:A(e)})))).join("")},updateColumns:function(t){return t=I(t),e.deep(this.options.columns,t),this.currentPage=this.currentPage},processRow:function(e){var t;return e.processed?e:(this.generateRow(e),a("visible",{updateEvenIfSame:!0}).of(e).to((t,s)=>t?(e.el.appendTo(this.els.tableBody),this.hasBreakdownBar&&!e.updatedBreakdownWidth&&t!==s?e.breakdownBarWidth=S(e,this.largestBreakdownTotal):void 0):e.el.detach()),this.hasBreakdownBar&&(null!=(t=e.breakdownBarEl)?t.length:void 0)&&a("largestBreakdownTotal").of(this).to("updatedBreakdownWidth").of(e).transform(function(){return!!e.visible}).and.to("breakdownBarWidth").of(e).transform(()=>S(e,this.largestBreakdownTotal)).chainTo("width").of(e.breakdownBarEl[0].style).transform(function(e){return e+"%"}).and.to(()=>{var t,i,a,n,r,o,l;for(a=i=0,n=(r=e.drilldownEls).length;i<n;a=++i)t=r[a],l=S(e.drilldown[a],e.drilldown.largestBreakdownTotal),null!=(o=s(t).children(".is_breakdown_bar").children().children()[0])&&(o.style.width=l+"%")}).condition(function(){return e.drilldown}).conditionAll(function(){return e.visible}),e.processed=!0,e)},unprocessRow:function(e){if(e.processed)return a.unBindAll(e,!0),this.hasBreakdownBar&&e.breakdownBarEl[0]&&a.unBindAll(e.breakdownBarEl[0].style),e.el.remove(),delete e.el,delete e.drilldownEls,delete e.visible,delete e.breakdownBarEl,delete e.processed},reRenderRow:function(e){return this.generateRow(e)},generateRow:function(e){var t,i;return i=e.el,t=e.el=s(this.generateRowMarkup(e)).data("row",e),i&&i.replaceWith(t),e.drilldown&&(e.expandButton=e.el.children().first()),e.drilldown&&(e.drilldownEls=e.el.children("._tableRowDrilldown").children()),this.hasBreakdownBar&&(e.breakdownBarEl=e.el.children(".isBreakdownBar").children().children()),i||(e.visible=!1),e.drilldown&&(this.hasBreakdownBar&&(e.drilldown.largestBreakdownTotal=Math.max(...e.drilldown.map(function(e){return e.breakdownBarTotal}))),a("drilldownOpen").of(e).to("className.drilldownState").of(e.el).transform(function(e){return e?"hasDrilldown drilldownIsOpen":"hasDrilldown"}),a("visible").of(e).once.to(function(){return a(function(){if(!e.drilldownOpen)return setTimeout(function(){var t,s;return s=e.el.height(),t=e.expandButton.height(),e.expandButton[0].style.top=`${s/2-t/2}px`})}).updateOn("event:resize",{throttle:300}).of(window)}).condition(function(e){return e})),e},generateRowMarkup:function(e,t){var s;return s=!!t,w(this.markupArgs({rowID:s?t[this.options.uniqueID]:e[this.options.uniqueID],drilldown:s?"":e.drilldown?(()=>{var t,s,i,a,n;for(t="",i=0,a=(n=e.drilldown).length;i<a;i++)s=n[i],t+=this.generateRowMarkup(s,e);return t})():void 0,cells:(()=>{var t,s,i,a,n;for(i in n="",a=this.options.columns)s=a[i],t=e[i],this.options.percentage[i]&&(t=this.calcPercentageString(t,i,e)),n+=b(this.markupArgs({label:"string"==typeof t?t:"",column:i,slug:s.slug,extraClasses:A(s),style:E(s),value:(()=>{switch(!1){case"fields"!==s.type:return this.generateInlineFields(t,e,s);case"ipDetails"!==s.type:return this.generateIpDetails(t,e,s);case"breakdownBar"!==s.type:return this.generateBreakdownBar(t,e,s);case"button"!==s.type:return this.generateButton(s.action||t,s.buttonIcon||s.icon);case"actions"!==s.type:return this.generateActions(s,e,s);case!s.isLink:return`<a href='${t}' target='_blank'>${t}</a>`;default:return s.formatter?s.formatter(t,e,s):t}})()}));return n})()}))},generateInlineFields:function(e){return B(this.markupArgs({fields:(()=>{var t,s;return"object"!=typeof e?"":function(){var i;for(t in i=[],e)s=e[t],i.push(k(this.markupArgs({label:t,value:s})));return i}.call(this).join("")})()}))},generateButton:function(e,t,s){return x(this.markupArgs({action:e,icon:t,isMulti:s}))},generateActions:function(e){return null==e.actions&&(e.actions="multiActions"),this.generateButton(e.actions,e.buttonIcon||e.icon,!0)+R(this.markupArgs({actions:(()=>{var e;return this.options.actions?function(){var t,s,i,a;for(a=[],t=0,s=(i=this.options.actions).length;t<s;t++)e=i[t],a.push(M(this.markupArgs(e)));return a}.call(this).join(""):""})()}))},generateIpDetails:function(e,t,s){return y(this.markupArgs({ipAddress:e,extra:"function"==typeof s.extraMarkup?s.extraMarkup(e,t):void 0}))}}),L=Object.freeze({attachEvents:function(){return this.els.pagination.on("click","._paginationItem",e=>{var t,i,a,n,r;if(i=(t=s(e.currentTarget)).hasClass("_back"),n=t.hasClass("_next"),a=t.hasClass("_extraIndicator"),i){if(1!==this.currentPage)return this.currentPage--}else if(n){if(this.currentPage!==this.pageCountReal)return this.currentPage++}else if(!a)return r=parseFloat(t.children().html()),this.currentPage=r}),this.els.tableHeading.on("click","._isSortable",e=>this.sortBy=e.currentTarget.children[0].textContent),this.els.tableBody.on("click","._actionButton",e=>{var t,i,a,n,r;return(i=s(e.currentTarget)).hasClass("_isMulti")?O(i.next().children()):(r=i.closest("._tableRow"),t=i.data("action"),n=r.data("row-id"),r.data("index"),null==(a=n?this.allRows.find(e=>D(e[this.options.uniqueID],n)):void 0)&&(a=n),i.hasClass("_subActionButton")&&O(i.parent()),this.els.table.trigger(`action.${t}`,a))}),this.els.tableBody.on("click","._expandDrilldown",e=>{var t;return(t=s(e.currentTarget).parent().data("row")).drilldownOpen=!t.drilldownOpen}),this.els.tableBody.on("mouseover","._ipDetails-trigger",e=>{var t,i,a,n;if(a=s(e.currentTarget),n=a.parent(),(t=a.next()).next(),i=n.data("ip"),!a.hasClass("_isReady"))return this.options.ipDataFetcher(i).then(e=>{var s,i,a;if(e)return i=function(){var t;for(s in t=[],e)a=e[s],t.push(C(this.markupArgs({label:s,value:a})));return t}.call(this),t.html(i.join("")),n.addClass("_isReady")})}),Promise.resolve()}}),V=Object.freeze({attachBindings:function(){var e,t,s;for(t in a.settings.trackArrayChildren=!1,a("noResults").of(this.state).to("className.isVisible").of(this.els.noResultsMessage).transform(e=>e&&!this.state.loading?"is_visible":"").and.to("className.noResults").of(this.els.tableOuterwrap).transform(e=>e&&!this.state.loading?"_noResults":""),a("loading").of(this.state).to("className.isVisible").of(this.els.loadingMessage).transform(function(e){return e?"is_visible":""}).and.to("className.loading").of(this.els.tableOuterwrap).transform(e=>e?"_loading":"").and.to(e=>this.state.noResults=!e&&!this.visibleRows.length),a("error").of(this.state).to("textContent.errorMessage").of(this.els.errorMessage).and.to("className.isVisible").of(this.els.errorMessage).transform(function(e){return e?"is_visible":""}).and.to("className.hasError").of(this.els.tableOuterwrap).transform(function(e){return e?"_error":""}).and.to(function(e){if(e)return console.error(e)}),this.options.hasMobile&&(this.windowWidth=window.innerWidth,a("event:resize").of(window).to(()=>this.windowWidth=window.innerWidth),a("windowWidth").of(this).to("className.mobileVersion").of(this.els.tableOuterwrap).transform(e=>e<=this.options.mobileWidth?"_mobileVersion":"")),s=this.options.columns)(e=>a("hidden").of(e).to(`innerHTML.${e.slug}`).of(this.els.globalStyles).transform(t=>t?`${this.tableID} .__${e.slug} {display:none}`:""))(e=s[t]);return a("array:visibleRows").of(this).to((e,t)=>{var s,i,a,n,r,o;if(null!=t?t.length:void 0)for(i=0,n=t.length;i<n;i++)(o=t[i]).visible=!1;try{for(a=0,r=e.length;a<r;a++)o=e[a],this.processRow(o),o.visible=!0}catch(e){s=e,this.state.error=s}return this.state.noResults=!e.length}).and.to(e=>{var t,s,i,a;if(this.hasBreakdownBar){for(t=0,i=e.length;t<i;t++)((a=e[t]).breakdownBarTotal>s||null==s)&&(s=a.breakdownBarTotal);return this.largestBreakdownTotal=s||0}}).and.to("textContent.rowRange").of(this.els.pageStatus).transform(e=>`${this.availableRows.indexOf(e[0])+1}-${this.availableRows.indexOf(e.slice(-1)[0])+1}`),a("array:allRows").of(this).to(e=>(this.searchCriteria="",this.currentPage=1,this.state.noResults=!e.length,this.sortBy===this.options.sortBy?(this.sortBy="",this.sortBy=this.options.sortBy):this.sortBy="")),a("availableRows",{updateOnBind:!1,updateEvenIfSame:!0}).of(this).to(e=>this.calcPageCount(e)).and.to("textContent.totalRows").of(this.els.pageStatus).transform(function(e){return e.length}),a("pageCount").of(this).to("innerHTML").of(this.els.paginationItems).transform(e=>{var t,s,i,a;for(s="",a=t=1,i=e;1<=i?t<=i:t>=i;a=1<=i?++t:--t)0!==a&&(s+=g(this.markupArgs({value:a})));return s}).and.to("className.isVisible").of(this.els.pagination).transform(function(e){return e>1?"is_visible":""}),a("pageCountReal").of(this).to("innerHTML").of(this.els.paginationExtraSelect).transform(e=>{var t,s,i,a,n;if(e<=this.options.pageCountMax)return"";for(i="<option>...</option>",s=t=a=this.options.pageCountMax+1,n=e;a<=n?t<=n:t>=n;s=a<=n?++t:--t)i+=`<option>${s}</option>`;return i}).and.to("className.hasExtra").of(this.els.pagination).transform(e=>e>this.options.pageCountMax?"has_extra":""),a("value",{updateOnBind:!1}).of(this.els.paginationExtraSelect).to("innerHTML").of(this.els.paginationExtraText).and.to("currentPage").of(this),a("currentPage",{updateEvenIfSame:!0}).of(this).transformSelf(e=>(e="..."===e?1:parseFloat(e))>this.pageCountReal?this.pageCountReal:e).to("value").of(this.els.paginationExtraSelect).transform(e=>e>this.options.pageCountMax?e:"...").and.to(e=>(this.setVisiblePage(e),this.setPageIndicator(e))),this.options.search.length&&(this.searchParam=this.options.search[0],a("search").of(this.options).to("innerHTML").of(this.els.searchParam).transform(function(e){return e.map(function(e){return`<option>${e}</option>`}).join("")}),a("value").of(this.els.searchParam).to("searchParam").of(this).pipe("attr:placeholder").of(this.els.searchCriteria).transform(function(e){return`Filter by ${e}`})),a("value").of(this.els.searchCriteria).to("searchCriteria",{updateEvenIfSame:!0}).of(this).bothWays().chainTo(t=>{var s,i,a;return i=this.allRows,a=this.options.columns[this.searchParam],t&&(a||null!=(null!=(s=this.allRows[0])?s[this.searchParam]:void 0))&&(i=i.filter(e=>{var s;return null!=(s=(null!=a?a.rawValueFormatter:void 0)?a.rawValueFormatter(e[this.searchParam]):e[this.searchParam])?s.toString().toLowerCase().includes(t.toLowerCase()):void 0})),this.options.rowFilter&&(i=i.filter(t=>{var s,i,a;for(s in a=extend.clone(t),i=this.options.columns)(e=i[s]).rawValueFormatter&&(a[s]=e.rawValueFormatter(a[s]));return this.options.rowFilter(a)})),this.availableRows=i,this.currentPage=1}),a("sortBy",{updateEvenIfSame:!0,updateOnBind:!1},!0).of(this).to((e,t)=>{var s;if(e||t)return e===t&&t?this.sortDirection*=-1:this.sortDirection=-1,s=e||null,this.availableRows=this.sortRows(this.availableRows,s),this.currentPage=1}),this.els.tableHeading.children("._isSortable").length&&a("sortBy",{updateOnBind:!0}).of(this).to("multi:className.currentSort").of(this.els.tableHeading.children("._isSortable")).transform(function(e,t,s){return e===s.children[0].textContent?"_currentSort":""}),a("sortDirection").of(this).to("className.sortDirection").of(this.els.table).transform(function(e){return-1===e?"desc":"asc"}),Promise.resolve()}}),H=Object.freeze({sortBy:function(e){}});r=0,n=class i extends t{constructor(t,a={}){return super(),this.container=t,this.options=e.clone.deepOnly("columns")(i.defaults,a),this.state={loading:!1,noResults:!1,error:!1},this.ID=++r,this.tableID=`#${this.options.baseClass}-${this.ID}`,this.visibleRows=[],this.availableRows=[],this.allRows=[],this.largestBreakdownTotal=0,this.searchCriteria="",this.searchParam="",this.sortBy=this.options.sortBy?this.options.sortBy:"",this.sortDirection=-1,this.currentPage=1,this.els={},this.els.tableOuterwrap=s(l(e({ID:this.ID},this.options))),this.els.table=s(c(this.options)).appendTo(this.els.tableOuterwrap),this.els.tableHeading=this.els.table.children().first().children(),this.els.tableBody=this.els.table.children().last(),this.els.noResultsMessage=s(d(this.options)).appendTo(this.els.tableOuterwrap),this.els.loadingMessage=s(u(this.options)).appendTo(this.els.tableOuterwrap),this.els.errorMessage=s(h(this.options)).appendTo(this.els.tableOuterwrap),this.els.pageStatus=s(p(this.options)).appendTo(this.els.tableOuterwrap),this.els.pagination=s(f(this.options)).appendTo(this.els.tableOuterwrap),this.els.paginationItems=this.els.pagination.children("._paginationItems"),this.els.paginationExtra=this.els.pagination.children("._extraIndicator"),this.els.paginationExtraSelect=this.els.paginationExtra.children("select"),this.els.paginationExtraText=this.els.paginationExtraSelect.prev(),this.els.searchField=s(m(this.options)).insertBefore(this.els.table),this.els.searchParam=this.els.searchField.children("select"),this.els.searchCriteria=this.els.searchField.children("input"),this.els.globalStyles=s("<style />").prependTo(this.els.tableOuterwrap),this.els.tableHeading.append(this.generateHeadingColumns()),this.els.tableOuterwrap.appendTo(this.container),this.els.table.data("DataTable",this),this.options.minWidth&&(this.els.table[0].style.minWidth=`${this.options.minWidth}px`),Promise.bind(this).then(this.attachEvents).then(this.attachBindings).then(function(){if(this.options.loadOnInit)return this.loadData()}),this}fetchData(){return this.state.loading=!0,Promise.resolve().then(()=>this.options.data.call(this)).then(e=>(this.state.loading=this.state.error=!1,e)).catch(e=>this.state.error=e)}setData(e){if(Array.isArray(e))return this.allRows=e}appendData(e){return this.allRows.push(...e)}loadData(){var e,t,s,i;if(this.allRows.length)for(e=0,t=(s=this.allRows).length;e<t;e++)i=s[e],this.unprocessRow(i);return this.fetchData().then(e=>this.setData(e))}refresh(){return this.availableRows=this.availableRows,this.currentPage=this.currentPage}markupArgs(e={}){return e.baseClass=this.options.baseClass,e}},e(n.prototype,F,L,V,H),n.version="2.10.1",n.helpers=W,n.markup=P,n.defaults=o;var j=n;return j});