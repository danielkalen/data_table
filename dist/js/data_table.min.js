!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("smart-extend"),require("event-lite"),require("jquery"),require("escape-html"),require("@danielkalen/simplybind")):"function"==typeof define&&define.amd?define(["smart-extend","event-lite","jquery","escape-html","@danielkalen/simplybind"],e):(t=t||self)["@danielkalen/data_table"]=e(t.extend,t.EventEmitter,t.$$1,t.escHTML,t.SimplyBind)}(this,function(t,e,s,i,a){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,s=s&&s.hasOwnProperty("default")?s.default:s,i=i&&i.hasOwnProperty("default")?i.default:i,a=a&&a.hasOwnProperty("default")?a.default:a;var n,r,o={perPage:20,pageCountMax:10,minWidth:0,mobileWidth:736,cellsHavePadding:!1,hasMobile:!0,loadOnInit:!0,columns:[],search:[],percentage:{},baseClass:"DataTable",showPageStatus:!0,sortBy:"",alignment:"left",actions:!1,ipDataFetcher:function(t){return new Promise(function(e){return $.get(`http://ipinfo.io/${t}`,e,"JSON")})}},l=function({ID:t,baseClass:e,minWidth:s,hasMobile:i,cellsHavePadding:a}){return`<div id='${e}-${t}' class='${e}-outerwrap {{loading}} {{noResults}} {{hasError}} ${s?"_hasMinWidth":""} ${i?"{{mobileVersion}}":""} ${a?"_cellsHavePadding":""} '></div>`},c=function({baseClass:t,alignment:e}){return`<div class='${t} alignment---${e} sortDirection---{{sortDirection}}'> <div class='${t}-heading'> <div class='${t}-heading-row'></div> </div> <div class='${t}-body'></div> </div>`},u=function({baseClass:t}){return`<div class='${t}-loading {{isVisible}}'> <div class='${t}-loading-innerwrap'> <div class='${t}-loading-icon'></div> <div class='${t}-loading-text'>Loading</div> </div> </div>`},d=function({baseClass:t,itemSingleLabel:e="Item",itemPluralLabel:s=e+"s"}){return`<div class='${t}-noResults {{isVisible}}'> <div class='${t}-noResults-innerwrap'> <div class='${t}-noResults-icon'></div> <div class='${t}-noResults-text'> <div class='${t}-noResults-text-title'>No ${e}s to Display</div> <div class='${t}-noResults-text-subtitle'>There are no matching ${s} for the search query you've typed.</div> </div> </div> </div>`},h=function({baseClass:t}){return`<div class='${t}-error {{isVisible}}'> <div class='${t}-error-innerwrap'> <div class='${t}-error-icon'></div> <div class='${t}-error-text'> <div class='${t}-error-text-title'>A Fatal Error has Occured</div> <div class='${t}-error-text-subtitle'>Report the following to the admin:<br />"{{errorMessage}}"</div> </div> </div> </div>`},p=function({baseClass:t,showPageStatus:e}){return`<div class='${t}-pageStatus ${e?"is_visible":""}'> Showing {{rowRange}} of {{totalRows}} </div>`},f=function({baseClass:t}){return`<div class='${t}-pagination {{hasExtra}} {{isVisible}}'> <div class='${t}-pagination-item _paginationItem _back'> <div class='${t}-pagination-item-text'></div> </div> <div class='${t}-pagination-itemswrap _paginationItems'></div> <div class='${t}-pagination-item _paginationItem _extraIndicator'> <div class='${t}-pagination-item-text'></div> <select class='${t}-pagination-item-select'></select> </div> <div class='${t}-pagination-item _paginationItem _next'> <div class='${t}-pagination-item-text'></div> </div> </div>`},g=function({baseClass:t,value:e}){return`<div class='${t}-pagination-item _paginationItem'> <div class='${t}-pagination-item-text'>${e}</div> </div>`},v=function({baseClass:t,extraClasses:e="",slug:s,icon:i="",label:a,style:n=""}){return`<div class='${t}-heading-row-cell ${e} __${s}' data-slug='${s}' data-icon='${i}' ${n}> <div class='${t}-heading-row-cell-text'>${a}</div> </div>`},w=function({baseClass:t,rowID:e,cells:s,drilldown:i=""}){return`<div class='${t}-body-row _tableRow {{drilldownState}}' data-row-id='${e}'> <div class='${t}-body-row-expandDrilldown _expandDrilldown'> <div class='${t}-body-row-expandDrilldown-icon'></div> </div> ${s} <div class='${t}-body-row-drilldown _tableRowDrilldown'> ${i} </div> </div>`},b=function({baseClass:t,extraClasses:e="",label:s,column:i,slug:a,value:n,style:r=""}){return`<div class='${t}-body-row-cell __${a} ${e}' data-slug='${a}' data-column='${i}' ${r}> <div class='${t}-body-row-cell-innerwrap' title='${s}'>${n}</div> </div>`},m=function({baseClass:t,search:e}){return`<div class='${t}-search ${(null!=e?e.length:void 0)?"is_visible":""}'> <select class='${t}-search-select'></select> <input class='${t}-search-input' /> <div class='${t}-search-selectTrigger'></div> </div>`},y=function({baseClass:t,ipAddress:e,extra:s=""}){return`<div class='${t}-ipDetails _ipDetails' data-ip='${e}'> <div class='${t}-ipDetails-trigger _ipDetails-trigger'></div> <div class='${t}-ipDetails-content'>Loading IP Details</div> </div> ${s}`},C=function({baseClass:t,label:e,value:s}){return`<div class='${t}-ipDetails-content-item'> <div class='${t}-ipDetails-content-item-label'>${e}: </div> <div class='${t}-ipDetails-content-item-value'>${s}</div> </div>`},B=function({baseClass:t,fields:e}){return`<div class='${t}-fieldGroup'>${e}</div>`},k=function({baseClass:t,label:e,value:s}){return`<div class='${t}-fieldGroup-item'> <div class='${t}-fieldGroup-item-label'>${e}: </div> <div class='${t}-fieldGroup-item-value'>${i(s)}</div> </div>`},x=function({baseClass:t,action:e,icon:s="",isMulti:i}){return`<div class='${t}-button _actionButton ${i?"_isMulti":""}' data-action='${e}'> <div class='${t}-button-icon'>${s}</div> </div>`},R=function({baseClass:t,actions:e}){return`<div class='${t}-actions'> <div class='${t}-actions-popup'>${e}</div> </div>`},_=function(){return`<div class='${j.defaults.baseClass}-actions-overlay'></div>`},M=function({baseClass:t,action:e,icon:s,label:i,customIconStyle:a=""}){return`<div class='${t}-actions-popup-item _actionButton _subActionButton' data-action='${e}' style='${a}'> <div class='${t}-actions-popup-item-icon'>${s}</div> <div class='${t}-actions-popup-item-text'>${i}</div> </div>`},P=Object.freeze({tableOuterwrap:l,table:c,loading:u,noResults:d,error:h,pageStatus:p,pagination:f,paginationItem:g,headingCell:v,row:w,rowCell:b,searchField:m,ipDetails:y,ipDetailsItem:C,fields:B,fieldsItem:k,button:x,actions:R,actionsOverlay:_,actionsItem:M}),D=function(t,e){switch(!1){case typeof t!=typeof e:return t===e;case"string"!=typeof t:return t===""+e;case"number"!=typeof t:return t===parseFloat(e)}},O=function(t){var e,i;return(e=t.data("isOpen"))?(t.data("overlay").remove(),t.removeClass("is_visible")):(t.data("overlay",i=s(_())),t.addClass("is_visible"),i.appendTo(document.body).one("click",function(){return O(t)})),t.data("isOpen",!e)},I=function(t){var e,s,i,a,n,r,o,l;if(Array.isArray(t)){if(o={},"string"==typeof t[0])for(s=0,n=t.length;s<n;s++)o[a=t[s]]={label:a};else if(null!=(l=t[0])?l.label:void 0)for(i=0,r=t.length;i<r;i++)o[(e=t[i]).label]=e}else o=t;for(a in o)null==(e=o[a]).label&&(e.label=a),null==e.slug&&(e.slug=e.label.toLowerCase().replace(/\W/g,"_")),null==e.type&&(e.type="text");return o},S=function(t,e){return t.breakdownBarTotal/e*82},T=function(t){var e;return e="",t.width&&(e+=`max-width: ${t.width};`),t.grow>=0&&(e+=`flex-grow: ${t.grow};`),e?`style='${e}'`:""},E=function(t){var e;return e="",t.width&&(e+=`max-width: ${t.width};`),t.color&&(e+=`color: ${this.colorMapping(t.color,t.colorType)};`),t.customStyle&&(e+=t.customStyle),t.grow>=0&&(e+=`flex-grow: ${t.grow};`),e?`style='${e}'`:""},A=function(t){var e;return e="",t.sortable&&(e+=" _isSortable {{currentSort}}"),t.noLabel&&(e+=" _noLabel"),t.isLink&&(e+=" _isLink"),t.noEllipsis&&(e+=" _noEllipsis"),t.showOverflow&&(e+=" _showOverflow"),t.color&&(e+=" _hasColor"),"button"!==t.type&&"actions"!==t.type||(e+=" _isButton",t.alwaysCenter=!0),"breakdownBar"===t.type&&(e+=" _isBreakdownBar"),"ipDetails"===t.type&&(e+=" _isIpDetails"),"fields"===t.type&&(e+=" _isFields"),t.alwaysCenter&&(e+=" _alwaysCenter"),e},W=Object.freeze({compareValues:D,toggleActionsPopup:O,getBreakdownTotal:function(t,e){switch(!1){case 0!==e.length:return 0;default:return e.map(function(e){return t[e]}).reduce(function(t,e){return t+e})}},normalizeColumns:I,getBreakdownBarWidth:S,genHeaderCellStyle:T,genCellStyle:E,genCellClassname:A,colorMapping:function(t,e="name"){switch(e){case"browser":switch(!1){case!t.includes("Firefox"):return this.colorMapping("orange");case!t.includes("Chrome"):return this.colorMapping("green");case!t.includes("Safari"):case!t.includes("Mobile Safari"):return this.colorMapping("blue");case!t.includes("IE"):case!t.includes("Edge"):return this.colorMapping("lightblue");case!t.includes("Opera"):return this.colorMapping("red");case!t.includes("Android"):return this.colorMapping("lightgreen");default:return"unknown"}break;case"platform":switch(t){case"Mac OS X":return this.colorMapping("black");case"Windows":return this.colorMapping("lightblue");case"Windows Phone":return this.colorMapping("purple");case"Linux":return this.colorMapping("darkyellow");case"iOS":return this.colorMapping("black");case"Android":return this.colorMapping("lightgreen");default:return"unknown"}break;case"satisfaction":switch(t){case"Excellent":return this.colorMapping("green");case"Normal":return this.colorMapping("yellow");case"Poor":return this.colorMapping("red");default:return"unknown"}break;case"name":switch(t){case"orange":return"#ee6f0e";case"green":return"#00ad09";case"blue":return"#4788f3";case"yellow":return"#eab71e";case"red":return"#cc4820";case"black":return"#181818";case"purple":return"#a020ba";case"lightblue":return"#0cb3ee";case"lightgreen":return"#78c257";case"darkyellow":return"#e8ac01"}break;default:return t}},iconMapping:function(t,e){switch(e){case"browser":switch(!1){case!t.includes("Firefox"):return"#";case!t.includes("Chrome"):return"%";case!t.includes("Safari"):case!t.includes("Mobile Safari"):return"$";case!t.includes("IE"):case!t.includes("Edge"):return"&";case!t.includes("Opera"):return'"';case!t.includes("Android"):return"&#039;";default:return"4"}break;case"device":switch(t){case"Desktop":return"!";case"Tablet":return"7";case"Mobile":return"6";default:return"4"}break;case"platform":switch(t){case"Mac OS X":return"*";case"Windows":case"Windows Phone":return")";case"Linux":return"+";case"iOS":return"*";case"Android":return"&#039;";default:return"4"}break;case"satisfaction":switch(t){case"Excellent":return"[";case"Normal":return"@";case"Poor":return"?";default:return"4"}break;default:return"4"}}}),F=Object.freeze({calcPageCount:function(t){return this.pageCountReal=Math.ceil(t.length/this.options.perPage),this.pageCount=this.pageCountReal>this.options.pageCountMax?this.options.pageCountMax:this.pageCountReal},calcPercentageString:function(t,e,s){var i,a,n,r,o;return n=this.options.percentage[e],i=n[0],a=n[2],r=n[1],Infinity===(o=function(){switch(r){case"*":return s[i]*s[a];case"/":return s[i]/s[a];case"+":return s[i]+s[a];case"-":return s[i]-s[a]}}())&&(o=0),`${t} (${convertToPercent(o)})`},sortRows:function(t,e=this.options.sortBy){var s,i,a;switch(!1){case"+"!==e:return t;case"-"!==e:return null!=t?t.slice().reverse():void 0;case!this.options.columns[e]:return s=this.options.columns[e].sortFn,i=this.options.columns[e].rawValueFormatter,(a=s)||(a=((t,s)=>{var a,n;switch(a=i?i(t[e]):t[e],n=i?i(s[e]):s[e],!1){case!(a>n):return this.sortDirection;case!(a<n):return-1*this.sortDirection;default:return 0}})),t.slice().sort(a);default:return t}},setVisiblePage:function(t){var e,s,i,a,n;for(n={start:--t*this.options.perPage,end:t*this.options.perPage+this.options.perPage},a=this.availableRows.slice(n.start,n.end),e=0,s=(i=this.visibleRows.slice()).length;e<s;e++)i[e].visible=!1;return this.visibleRows.length=0,this.visibleRows.push.apply(this.visibleRows,a)},setPageIndicator:function(t){var e,s;return"..."===t&&(t=1),t=t>this.options.pageCountMax?this.options.pageCountMax:t-1,(e=(s=this.els.pagination.find("._paginationItem").slice(1,-1)).eq(t)).addClass("current"),s.not(e).removeClass("current")},generateHeadingColumns:function(){var t,e;return this.options.columns=I(this.options.columns),function(){var s,i;for(e in i=[],s=this.options.columns)t=s[e],i.push("breakdownBar"===t.type);return i}.call(this)&&(this.hasBreakdownBar=!0),Object.keys(this.options.columns).map(e=>(t=this.options.columns[e],this.els.globalStyles[0].innerHTML+=`{{${t.slug}}}\n`,v(this.markupArgs({slug:t.slug,icon:t.icon,label:t.label,style:T(t),extraClasses:A(t)})))).join("")},updateColumns:function(e){return e=I(e),t.deep(this.options.columns,e),this.currentPage=this.currentPage},processRow:function(t){var e;return t.processed?t:(this.generateRow(t),a("visible",{updateEvenIfSame:!0}).of(t).to((e,s)=>e?(t.el.appendTo(this.els.tableBody),this.hasBreakdownBar&&!t.updatedBreakdownWidth&&e!==s?t.breakdownBarWidth=S(t,this.largestBreakdownTotal):void 0):t.el.detach()),this.hasBreakdownBar&&(null!=(e=t.breakdownBarEl)?e.length:void 0)&&a("largestBreakdownTotal").of(this).to("updatedBreakdownWidth").of(t).transform(function(){return!!t.visible}).and.to("breakdownBarWidth").of(t).transform(()=>S(t,this.largestBreakdownTotal)).chainTo("width").of(t.breakdownBarEl[0].style).transform(function(t){return t+"%"}).and.to(()=>{var e,i,a,n,r,o,l;for(a=i=0,n=(r=t.drilldownEls).length;i<n;a=++i)e=r[a],l=S(t.drilldown[a],t.drilldown.largestBreakdownTotal),null!=(o=s(e).children(".is_breakdown_bar").children().children()[0])&&(o.style.width=l+"%")}).condition(function(){return t.drilldown}).conditionAll(function(){return t.visible}),t.processed=!0,t)},unprocessRow:function(t){if(t.processed)return a.unBindAll(t,!0),this.hasBreakdownBar&&t.breakdownBarEl[0]&&a.unBindAll(t.breakdownBarEl[0].style),t.el.remove(),delete t.el,delete t.drilldownEls,delete t.visible,delete t.breakdownBarEl,delete t.processed},reRenderRow:function(t){return this.generateRow(t)},generateRow:function(t){var e,i;return i=t.el,e=t.el=s(this.generateRowMarkup(t)).data("row",t),i&&i.replaceWith(e),t.drilldown&&(t.expandButton=t.el.children().first()),t.drilldown&&(t.drilldownEls=t.el.children("._tableRowDrilldown").children()),this.hasBreakdownBar&&(t.breakdownBarEl=t.el.children(".isBreakdownBar").children().children()),i||(t.visible=!1),t.drilldown&&(this.hasBreakdownBar&&(t.drilldown.largestBreakdownTotal=Math.max(...t.drilldown.map(function(t){return t.breakdownBarTotal}))),a("drilldownOpen").of(t).to("className.drilldownState").of(t.el).transform(function(t){return t?"hasDrilldown drilldownIsOpen":"hasDrilldown"}),a("visible").of(t).once.to(function(){return a(function(){if(!t.drilldownOpen)return setTimeout(function(){var e,s;return s=t.el.height(),e=t.expandButton.height(),t.expandButton[0].style.top=`${s/2-e/2}px`})}).updateOn("event:resize",{throttle:300}).of(window)}).condition(function(t){return t})),t},generateRowMarkup:function(t,e){var s;return s=!!e,w(this.markupArgs({rowID:s?e[this.options.uniqueID]:t[this.options.uniqueID],drilldown:s?"":t.drilldown?(()=>{var e,s,i,a,n;for(e="",i=0,a=(n=t.drilldown).length;i<a;i++)s=n[i],e+=this.generateRowMarkup(s,t);return e})():void 0,cells:(()=>{var e,s,i,a,n;for(i in n="",a=this.options.columns)s=a[i],e=t[i],this.options.percentage[i]&&(e=this.calcPercentageString(e,i,t)),n+=b(this.markupArgs({label:"string"==typeof e?e:"",column:i,slug:s.slug,extraClasses:A(s),style:E(s),value:(()=>{switch(!1){case"fields"!==s.type:return this.generateInlineFields(e,t,s);case"ipDetails"!==s.type:return this.generateIpDetails(e,t,s);case"breakdownBar"!==s.type:return this.generateBreakdownBar(e,t,s);case"button"!==s.type:return this.generateButton(s.action||e,s.buttonIcon||s.icon);case"actions"!==s.type:return this.generateActions(s,t,s);case!s.isLink:return`<a href='${e}' target='_blank'>${e}</a>`;default:return s.formatter?s.formatter(e,t,s):e}})()}));return n})()}))},generateInlineFields:function(t){return B(this.markupArgs({fields:(()=>{var e,s;return"object"!=typeof t?"":function(){var i;for(e in i=[],t)s=t[e],i.push(k(this.markupArgs({label:e,value:s})));return i}.call(this).join("")})()}))},generateButton:function(t,e,s){return x(this.markupArgs({action:t,icon:e,isMulti:s}))},generateActions:function(t){return null==t.actions&&(t.actions="multiActions"),this.generateButton(t.actions,t.buttonIcon||t.icon,!0)+R(this.markupArgs({actions:(()=>{var t;return this.options.actions?function(){var e,s,i,a;for(a=[],e=0,s=(i=this.options.actions).length;e<s;e++)t=i[e],a.push(M(this.markupArgs(t)));return a}.call(this).join(""):""})()}))},generateIpDetails:function(t,e,s){return y(this.markupArgs({ipAddress:t,extra:"function"==typeof s.extraMarkup?s.extraMarkup(t,e):void 0}))}}),L=Object.freeze({attachEvents:function(){return this.els.pagination.on("click","._paginationItem",t=>{var e,i,a,n,r;if(i=(e=s(t.currentTarget)).hasClass("_back"),n=e.hasClass("_next"),a=e.hasClass("_extraIndicator"),i){if(1!==this.currentPage)return this.currentPage--}else if(n){if(this.currentPage!==this.pageCountReal)return this.currentPage++}else if(!a)return r=parseFloat(e.children().html()),this.currentPage=r}),this.els.tableHeading.on("click","._isSortable",t=>this.sortBy=t.currentTarget.children[0].textContent),this.els.tableBody.on("click","._actionButton",t=>{var e,i,a,n,r;return(i=s(t.currentTarget)).hasClass("_isMulti")?O(i.next().children()):(r=i.closest("._tableRow"),e=i.data("action"),n=r.data("row-id"),r.data("index"),null==(a=n?this.allRows.find(t=>D(t[this.options.uniqueID],n)):void 0)&&(a=n),i.hasClass("_subActionButton")&&O(i.parent()),this.els.table.trigger(`action.${e}`,a))}),this.els.tableBody.on("click","._expandDrilldown",t=>{var e;return(e=s(t.currentTarget).parent().data("row")).drilldownOpen=!e.drilldownOpen}),this.els.tableBody.on("mouseover","._ipDetails-trigger",t=>{var e,i,a,n;if(a=s(t.currentTarget),n=a.parent(),(e=a.next()).next(),i=n.data("ip"),!a.hasClass("_isReady"))return this.options.ipDataFetcher(i).then(t=>{var s,i,a;if(t)return i=function(){var e;for(s in e=[],t)a=t[s],e.push(C(this.markupArgs({label:s,value:a})));return e}.call(this),e.html(i.join("")),n.addClass("_isReady")})}),Promise.resolve()}}),V=Object.freeze({attachBindings:function(){var e,s,i;for(s in a.settings.trackArrayChildren=!1,a("noResults").of(this.state).to("className.isVisible").of(this.els.noResultsMessage).transform(t=>t&&!this.state.loading?"is_visible":"").and.to("className.noResults").of(this.els.tableOuterwrap).transform(t=>t&&!this.state.loading?"_noResults":""),a("loading").of(this.state).to("className.isVisible").of(this.els.loadingMessage).transform(function(t){return t?"is_visible":""}).and.to("className.loading").of(this.els.tableOuterwrap).transform(t=>t?"_loading":"").and.to(t=>this.state.noResults=!t&&!this.visibleRows.length),a("error").of(this.state).to("textContent.errorMessage").of(this.els.errorMessage).and.to("className.isVisible").of(this.els.errorMessage).transform(function(t){return t?"is_visible":""}).and.to("className.hasError").of(this.els.tableOuterwrap).transform(function(t){return t?"_error":""}).and.to(function(t){if(t)return console.error(t)}),this.options.hasMobile&&(this.windowWidth=window.innerWidth,a("event:resize").of(window).to(()=>this.windowWidth=window.innerWidth),a("windowWidth").of(this).to("className.mobileVersion").of(this.els.tableOuterwrap).transform(t=>t<=this.options.mobileWidth?"_mobileVersion":"")),i=this.options.columns)(t=>a("hidden").of(t).to(`innerHTML.${t.slug}`).of(this.els.globalStyles).transform(e=>e?`${this.tableID} .__${t.slug} {display:none}`:""))(e=i[s]);return a("array:visibleRows").of(this).to((t,e)=>{var s,i,a,n,r,o;if(null!=e?e.length:void 0)for(i=0,n=e.length;i<n;i++)(o=e[i]).visible=!1;try{for(a=0,r=t.length;a<r;a++)o=t[a],this.processRow(o),o.visible=!0}catch(t){s=t,this.state.error=s}return this.state.noResults=!t.length}).and.to(t=>{var e,s,i,a;if(this.hasBreakdownBar){for(e=0,i=t.length;e<i;e++)((a=t[e]).breakdownBarTotal>s||null==s)&&(s=a.breakdownBarTotal);return this.largestBreakdownTotal=s||0}}).and.to("textContent.rowRange").of(this.els.pageStatus).transform(t=>`${this.availableRows.indexOf(t[0])+1}-${this.availableRows.indexOf(t.slice(-1)[0])+1}`),a("array:allRows").of(this).to(t=>(this.searchCriteria="",this.currentPage=1,this.state.noResults=!t.length,this.sortBy===this.options.sortBy?(this.sortBy="",this.sortBy=this.options.sortBy):this.sortBy="")),a("availableRows",{updateOnBind:!1,updateEvenIfSame:!0}).of(this).to(t=>this.calcPageCount(t)).and.to("textContent.totalRows").of(this.els.pageStatus).transform(function(t){return t.length}),a("pageCount").of(this).to("innerHTML").of(this.els.paginationItems).transform(t=>{var e,s,i,a;for(s="",a=e=1,i=t;1<=i?e<=i:e>=i;a=1<=i?++e:--e)0!==a&&(s+=g(this.markupArgs({value:a})));return s}).and.to("className.isVisible").of(this.els.pagination).transform(function(t){return t>1?"is_visible":""}),a("pageCountReal").of(this).to("innerHTML").of(this.els.paginationExtraSelect).transform(t=>{var e,s,i,a,n;if(t<=this.options.pageCountMax)return"";for(i="<option>...</option>",s=e=a=this.options.pageCountMax+1,n=t;a<=n?e<=n:e>=n;s=a<=n?++e:--e)i+=`<option>${s}</option>`;return i}).and.to("className.hasExtra").of(this.els.pagination).transform(t=>t>this.options.pageCountMax?"has_extra":""),a("value",{updateOnBind:!1}).of(this.els.paginationExtraSelect).to("innerHTML").of(this.els.paginationExtraText).and.to("currentPage").of(this),a("currentPage",{updateEvenIfSame:!0}).of(this).transformSelf(t=>(t="..."===t?1:parseFloat(t))>this.pageCountReal?this.pageCountReal:t).to("value").of(this.els.paginationExtraSelect).transform(t=>t>this.options.pageCountMax?t:"...").and.to(t=>(this.setVisiblePage(t),this.setPageIndicator(t))),this.options.search.length&&(this.searchParam=this.options.search[0],a("search").of(this.options).to("innerHTML").of(this.els.searchParam).transform(function(t){return t.map(function(t){return`<option>${t}</option>`}).join("")}),a("value").of(this.els.searchParam).to("searchParam").of(this).pipe("attr:placeholder").of(this.els.searchCriteria).transform(function(t){return`Filter by ${t}`})),a("value").of(this.els.searchCriteria).to("searchCriteria",{updateEvenIfSame:!0}).of(this).bothWays().chainTo(s=>{var i,a,n;return a=this.allRows,n=this.options.columns[this.searchParam],s&&(n||null!=(null!=(i=this.allRows[0])?i[this.searchParam]:void 0))&&(a=a.filter(t=>{var e;return null!=(e=(null!=n?n.rawValueFormatter:void 0)?n.rawValueFormatter(t[this.searchParam]):t[this.searchParam])?e.toString().toLowerCase().includes(s.toLowerCase()):void 0})),this.options.rowFilter&&(a=a.filter(s=>{var i,a,n;for(i in n=t.clone(s),a=this.options.columns)(e=a[i]).rawValueFormatter&&(n[i]=e.rawValueFormatter(n[i]));return this.options.rowFilter(n)})),this.availableRows=a,this.currentPage=1}),a("sortBy",{updateEvenIfSame:!0,updateOnBind:!1},!0).of(this).to((t,e)=>{var s;if(t||e)return t===e&&e?this.sortDirection*=-1:this.sortDirection=-1,s=t||null,this.availableRows=this.sortRows(this.availableRows,s),this.currentPage=1}),this.els.tableHeading.children("._isSortable").length&&a("sortBy",{updateOnBind:!0}).of(this).to("multi:className.currentSort").of(this.els.tableHeading.children("._isSortable")).transform(function(t,e,s){return t===s.children[0].textContent?"_currentSort":""}),a("sortDirection").of(this).to("className.sortDirection").of(this.els.table).transform(function(t){return-1===t?"desc":"asc"}),Promise.resolve()}}),H=Object.freeze({sortBy:function(t){}});r=0,n=class i extends e{constructor(e,a={}){return super(),this.container=e,this.options=t.clone.deepOnly("columns")(i.defaults,a),this.state={loading:!1,noResults:!1,error:!1},this.ID=++r,this.tableID=`#${this.options.baseClass}-${this.ID}`,this.visibleRows=[],this.availableRows=[],this.allRows=[],this.largestBreakdownTotal=0,this.searchCriteria="",this.searchParam="",this.sortBy=this.options.sortBy?this.options.sortBy:"",this.sortDirection=-1,this.currentPage=1,this.els={},this.els.tableOuterwrap=s(l(t({ID:this.ID},this.options))),this.els.table=s(c(this.options)).appendTo(this.els.tableOuterwrap),this.els.tableHeading=this.els.table.children().first().children(),this.els.tableBody=this.els.table.children().last(),this.els.noResultsMessage=s(d(this.options)).appendTo(this.els.tableOuterwrap),this.els.loadingMessage=s(u(this.options)).appendTo(this.els.tableOuterwrap),this.els.errorMessage=s(h(this.options)).appendTo(this.els.tableOuterwrap),this.els.pageStatus=s(p(this.options)).appendTo(this.els.tableOuterwrap),this.els.pagination=s(f(this.options)).appendTo(this.els.tableOuterwrap),this.els.paginationItems=this.els.pagination.children("._paginationItems"),this.els.paginationExtra=this.els.pagination.children("._extraIndicator"),this.els.paginationExtraSelect=this.els.paginationExtra.children("select"),this.els.paginationExtraText=this.els.paginationExtraSelect.prev(),this.els.searchField=s(m(this.options)).insertBefore(this.els.table),this.els.searchParam=this.els.searchField.children("select"),this.els.searchCriteria=this.els.searchField.children("input"),this.els.globalStyles=s("<style />").prependTo(this.els.tableOuterwrap),this.els.tableHeading.append(this.generateHeadingColumns()),this.els.tableOuterwrap.appendTo(this.container),this.els.table.data("DataTable",this),this.options.minWidth&&(this.els.table[0].style.minWidth=`${this.options.minWidth}px`),Promise.bind(this).then(this.attachEvents).then(this.attachBindings).then(function(){if(this.options.loadOnInit)return this.loadData()}),this}fetchData(){return this.state.loading=!0,Promise.resolve().then(()=>this.options.data.call(this)).then(t=>(this.state.loading=this.state.error=!1,t)).catch(t=>this.state.error=t)}setData(t){if(Array.isArray(t))return this.allRows=t}appendData(t){return this.allRows.push(...t)}loadData(){var t,e,s,i;if(this.allRows.length)for(t=0,e=(s=this.allRows).length;t<e;t++)i=s[t],this.unprocessRow(i);return this.fetchData().then(t=>this.setData(t))}refresh(){return this.availableRows=this.availableRows,this.currentPage=this.currentPage}markupArgs(t={}){return t.baseClass=this.options.baseClass,t}},t(n.prototype,F,L,V,H),n.version="2.10.2",n.helpers=W,n.markup=P,n.defaults=o;var j=n;return j});