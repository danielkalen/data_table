!function(t){var e,a,i;return i={table:"<div class='data_table-outerwrap'> <table class='data_table chart horizontal {{hasCheckbox}}'> <thead class='data_table-head'> <tr class='data_table-head-row'> <th class='data_table-head-row-cell checkbox'> <div class='data_table-head-row-cell-text'><input class='data_table-checkbox' type='checkbox'></div> </th> <th class='data_table-head-row-cell is_expand_button'></th> {{columns}} </tr> </thead> <tbody class='data_table-body'></tbody> </table> {{pagination}} </div>",table_head_cell:"<th class='data_table-head-row-cell {{isSortable}} {{slug}}' data-slug='{{slug}}' data-icon='{{icon}}'> <div class='data_table-head-row-cell-text'>{{label}}</div> </th>",table_body_row:"<tr class='data_table-body-row {{isSub}}' data-id='{{itemID}}'> <td class='data_table-body-row-cell checkbox'> <input class='data_table-checkbox' type='checkbox' data-id='{{itemID}}'> </td> <td class='data_table-body-row-cell is_expand_button'> <div class='data_table-body-row-cell-expand'></div> </td> {{cells}} </tr>",table_body_row_cell:"<td class='data_table-body-row-cell cell_{{slug}}' data-slug='{{slug}}'> <div class='data_table-body-row-cell-innerwrap'>{{value}}</div> </td>",table_body_row_cell_ip_details:"<div class='data_table-ip_details' data-ip={{ipAddress}}> <div class='data_table-ip_details-trigger'> <div class='data_table-ip_details-content'>Loading IP Details</div> </div> <div class='data_table-ip_details-country'></div> </div>",table_body_row_cell_ip_details_item:"<div class='data_table-ip_details-content-item'> <div class='data_table-ip_details-content-item-label'>{{label}}: </div> <div class='data_table-ip_details-content-item-value'>{{value}}</div> </div>",table_body_row_cell_fields:"<div class='data_table-fields'>{{fields}}</div>",table_body_row_cell_fields_item:"<div class='data_table-fields-item'> <div class='data_table-fields-item-label'>{{label}}: </div> <div class='data_table-fields-item-value'>{{value}}</div> </div>",table_body_row_cell_actions:"<div class='data_table-actions'>{{actions}}</div>",table_body_row_cell_actions_item:"<div class='data_table-actions-button color_{{color}}' data-action='{{action}}' data-icon='{{icon}}'> <div class='data_table-actions-button-text'>{{label}}</div> </div>",pagination:"<div class='data_table-pagination block-pagination'> <div class='data_table-pagination-item back'> <div class='data_table-pagination-item-text'></div> </div> {{pages}} <div class='data_table-pagination-item next'> <div class='data_table-pagination-item-text'></div> </div> </div>",pagination_item:"<div class='data_table-pagination-item'> <div class='data_table-pagination-item-text'>{{value}}</div> </div>"},a={checkbox:!0,perPage:20,actions:!1,ipDataFetcher:function(e){return new Promise(function(a){return t.get("http://ipinfo.io/"+e,a,"JSON")})}},e=function(e,l){return this.container=e,this.options=l,this.tableOptions=t.extend({},a,this.options.table||{}),this.data=[],this.els={},this.els.tableOuterwrap=t(i.table.replace("{{hasCheckbox}}",this.tableOptions.checkbox?"has_checkbox":"").replace("{{columns}}",this.generateColumns()).replace("{{pagination}}",i.pagination)),this.els.table=this.els.tableOuterwrap.children().first(),this.els.tableHead=this.els.table.children().first().children(),this.els.tableBody=this.els.table.children().last(),this.els.pagination=this.els.tableOuterwrap.children().last(),this.els.tableOuterwrap.appendTo(this.container),this.els.table.data("DataTable",this),this.attachEvents().then(function(t){return function(){return t.attachBindings().then(function(){return t.fetchData()})}}(this)),this},e.prototype.fetchData=function(){return this.options.data().then(function(t){return function(e){return t.data=e}}(this))},e.prototype.generateColumns=function(){return this.options.columns.map(function(t){return i.table_head_cell.replace("{{isSortable}}",t.sorting?"is_sortable":"").replace(/\{\{slug\}\}/g,t.label.toLowerCase().replace(/\W/g,"_")).replace("{{icon}}",t.icon||"").replace("{{label}}",t.label)}).join("")},e.prototype.generateBodyRows=function(t){var e,a,l,n,r,s,o,c,d,u;for(c="",e=function(t){return function(e,a,l){return c+=i.table_body_row.replace("{{isSub}}",l?"is_sub is_hidden":"").replace(/\{\{itemID\}\}/g,l?a.ID:e.ID).replace("{{cells}}",function(){var a,l,n,r,s,o,c;for(c="",o=t.options.columns,r=n=0,s=o.length;s>n;r=++n)l=o[r],a=e[l.label]||"",c+=i.table_body_row_cell.replace(/\{\{slug\}\}/g,l.label.toLowerCase().replace(/\W/g,"_")).replace("{{value}}",function(){var e,i;switch(l.type){case"fields":return t.generateInlineFields(a);case"actions":return t.generateActions();case"ip-details":return t.generateIpDetails(a);default:return(null!=(i=t.options.formatters)&&"function"==typeof i[e=l.label]?i[e](a):void 0)||a}});return c})}}(this),a=0,n=t.length;n>a;a++)if(o=t[a],s=o.main||o,u=o.sub){for(e(s),l=0,r=u.length;r>l;l++)d=u[l],e(d,s,!0);this.els.table.addClass("is_expanding_table")}else e(s);return c},e.prototype.generateInlineFields=function(t){return i.table_body_row_cell_fields.replace("{{fields}}",function(){var e,a,l;return"object"!=typeof t?"":(a=function(){var a;a=[];for(e in t)l=t[e],a.push(i.table_body_row_cell_fields_item.replace("{{label}}",e).replace("{{value}}",l));return a}(),a.join(""))})},e.prototype.generateActions=function(){return i.table_body_row_cell_actions.replace("{{actions}}",function(t){return function(){var e,a;return t.tableOptions.actions?(a=function(){var t,a,l,n;for(l=this.tableOptions.actions,n=[],t=0,a=l.length;a>t;t++)e=l[t],n.push(i.table_body_row_cell_actions_item.replace("{{action}}",e.action).replace("{{label}}",e.label).replace("{{icon}}",e.icon).replace("{{color}}",e.color||"grey"));return n}.call(t),a.join("")):""}}(this))},e.prototype.generateIpDetails=function(t){return i.table_body_row_cell_ip_details.replace("{{ipAddress}}",t)},e.prototype.attachEvents=function(){return this.els.tableHead.on("click","th.is_sortable",function(t){return function(e){return t.sortBy(e.currentTarget.dataset.slug)}}(this)),this.els.tableBody.on("click",".data_table-actions-button",function(e){return function(a){var i,l,n,r,s;return i=t(a.currentTarget),l=i.closest("tr"),n=i.data("action"),r=l.data("id"),s=l.index(),e.els.table.trigger("action."+n,{itemID:r,data:e.data[s]})}}(this)),this.els.tableBody.on("click",".data_table-body-row-cell-expand",function(e){return function(e){var a,i,l;return a=t(e.currentTarget),i=a.closest("tr"),l=i.data("row-id"),i.siblings(".is_sub").filter(function(){return this.dataset.rowId===l}).toggleClass("is_hidden"),i.toggleClass("expanded")}}(this)),SimplyBind("currentPage").of(this).to(function(t){return function(){var e;return e=t.els.pagination.children().slice(1,-1).eq(t.currentPage-1),e.addClass("current").siblings().removeClass("current")}}(this)),this.els.pagination.on("click",".data_table-pagination-item",function(e){return function(a){var i,l,n,r;if(i=t(a.currentTarget),l=i.hasClass("back"),n=i.hasClass("next"),l){if(1!==e.currentPage)return e.currentPage--}else{if(!n)return r=parseFloat(i.children().html()),e.currentPage=r;if(e.currentPage!==e.pageCount)return e.currentPage++}}}(this)),this.els.tableBody.on("mouseover",".data_table-ip_details-trigger",function(e){return function(a){var l,n,r,s,o;return r=t(a.currentTarget),l=r.children(),n=r.next(),s=r.parent().data("ip"),o=r.data("isLoaded"),o?void 0:(r.data("isLoaded",!o),e.tableOptions.ipDataFetcher(s).then(function(t){var e,a,n;if(t)return a=function(){var a;a=[];for(e in t)n=t[e],a.push(i.table_body_row_cell_ip_details_item.replace("{{label}}",e).replace("{{value}}",n));return a}(),l.html(a.join("")),r.parent().addClass("ready")}))}}(this)),Promise.resolve()},e.prototype.attachBindings=function(){return SimplyBind.setOption("invokeOnBind",!0),SimplyBind("data").of(this).to(function(t){return function(e){return t.pageCount=Math.ceil(e.length/t.tableOptions.perPage),t.pageCount>15&&(t.pageCount=15),t.currentPage=1}}(this)).and("prop:innerHTML").of(this.els.tableBody).transform(function(t){return function(e){return t.generateBodyRows(e)}}(this)).and(function(t){return function(){return SimplyBind.setOption("updateEvenIfSame",!0),t.currentPage=1,SimplyBind.setOption("updateEvenIfSame",!1)}}(this)),SimplyBind("pageCount").of(this).to("prop:innerHTML.pages").of(this.els.pagination).transform(function(t){var e,a,l,n;for(l="",a=e=1,n=t;n>=1?n>=e:e>=n;a=n>=1?++e:--e)0!==a&&(l+=i.pagination_item.replace("{{value}}",a));return l}),SimplyBind("currentPage").of(this).to(function(t){return function(e){var a,i,l;return a=t.els.tableBody.children(),l=a.slice((e-1)*t.tableOptions.perPage).slice(0,t.tableOptions.perPage),i=a.not(".hidden"),i.length===a.length&&(i=a.slice(t.tableOptions.perPage)),i.addClass("hidden"),l.removeClass("hidden")}}(this)),SimplyBind.setOption("invokeOnBind",!1),Promise.resolve()},e.prototype.sortBy=function(t){},window.DataTable=e}(jQuery);
